@if(loaded){
<ion-header [translucent]="true" id="header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ changaOverview.title }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{ changaOverview.title }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-img [src]="changaOverview.photo_url" class="image-container"></ion-img>
  <div class="ion-padding">
    <app-customer-overview
      [customerName]="changaOverview.provider_summary.name"
      [customerEmail]="changaOverview.provider_summary.email"
      [customerPhotoUrl]="changaOverview.provider_summary.photo_url"
    ></app-customer-overview>
  </div>
  <div class="ion-padding">
    @if(changaOverview.available) { @if(isProvider) {
    <ion-button
      shape="round"
      expand="block"
      color="warning"
      [routerLink]="['/edit-changa', changaOverview.id]"
    >
      Editar
    </ion-button>
    <ion-button
      shape="round"
      expand="block"
      color="danger"
      id="present-delete-alert"
    >
      Eliminar
    </ion-button>
    <ion-alert
      trigger="present-delete-alert"
      header="Confirmar acción"
      message="¿Estás seguro que deseas eliminar esta changa?"
      [buttons]="[
      {
        text: 'Cancelar',
        role: 'cancel',
        cssClass: 'secondary',
      },
      {
        text: 'Eliminar',
        handler: deleteButtonHandler,
      },
    ]"
    ></ion-alert>
    } @else {
    <ion-button
      shape="round"
      expand="block"
      color="warning"
      [routerLink]="['/checkout', changaOverview.id]"
    >
      Solicitar
    </ion-button>
    
    
      
        <app-question [changaId] = "changaOverview.id">
        
        </app-question>
      

    } } @else {
    <ion-button shape="round" expand="block" disabled>
      No disponible
    </ion-button>
    }
  </div>
  <div class="ion-padding">
    @for (topic of changaOverview.topics; track changaOverview.id) {
    <ion-chip
      color="warning"
      [routerLink]="['/search-results']"
      [queryParams]="{topics:[topic]}"
    >
      {{ topic }}
    </ion-chip>
    }
  </div>
  <div class="ion-padding">
    <h5>Descripcion del servicio</h5>
    <p>{{ changaOverview.description }}</p>
  </div>  
  <div class="ion-padding">
    <h5>Opiniones del servicio</h5>
    <app-average-rating [changaId]="changaOverview.id"></app-average-rating>
  </div>
  <div class="ion-padding">
    <app-review-list [changaId]="changaOverview.id"></app-review-list>
  </div>
</ion-content>
} @else {
<div class="center-container">
  <ion-spinner></ion-spinner>
</div>
}
